!function(u,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define("whatInput",[],o):"object"==typeof exports?exports.whatInput=o():u.whatInput=o()}(this,function(){return function(p){var u={};function o(s){if(u[s])return u[s].exports;var i=u[s]={exports:{},id:s,loaded:!1};return p[s].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}return o.m=p,o.c=u,o.p="",o(0)}([function(p,u){"use strict";p.exports=function(){if("undefined"==typeof document||"undefined"==typeof window)return{ask:function(){return"initial"},element:function(){return null},ignoreKeys:function(){},specificKeys:function(){},registerOnChange:function(){},unRegisterOnChange:function(){}};var o=document.documentElement,s=null,i="initial",a=i,b=Date.now(),g=!1,C=["button","input","select","textarea"],c=[],M=[16,17,18,91,93],w=[],y={keydown:"keyboard",keyup:"keyboard",mousedown:"mouse",mousemove:"mouse",MSPointerDown:"pointer",MSPointerMove:"pointer",pointerdown:"pointer",pointermove:"pointer",touchstart:"touch",touchend:"touch"},h=!1,v={x:null,y:null},I={2:"touch",3:"touch",4:"mouse"},S=!1;try{var T=Object.defineProperty({},"passive",{get:function(){S=!0}});window.addEventListener("test",null,T)}catch(n){}var e,D=function(){if(g=!("false"===o.getAttribute("data-whatpersist")||"false"===document.body.getAttribute("data-whatpersist")))try{window.sessionStorage.getItem("what-input")&&(i=window.sessionStorage.getItem("what-input")),window.sessionStorage.getItem("what-intent")&&(a=window.sessionStorage.getItem("what-intent"))}catch(e){}f("input"),f("intent")},d=function(e){var t=e.which,r=y[e.type];"pointer"===r&&(r=k(e));var F=!w.length&&-1===M.indexOf(t),W=w.length&&-1!==w.indexOf(t),L="keyboard"===r&&t&&(F||W)||"mouse"===r||"touch"===r;if(O(r)&&(L=!1),L&&i!==r&&(E("input",i=r),f("input")),L&&a!==r){var l=document.activeElement;l&&l.nodeName&&(-1===C.indexOf(l.nodeName.toLowerCase())||"button"===l.nodeName.toLowerCase()&&!R(l,"form"))&&(E("intent",a=r),f("intent"))}},f=function(e){o.setAttribute("data-what"+e,"input"===e?i:a),N(e)},m=function(e){var t=y[e.type];"pointer"===t&&(t=k(e)),_(e),(!h&&!O(t)||h&&"wheel"===e.type||"mousewheel"===e.type||"DOMMouseScroll"===e.type)&&a!==t&&(E("intent",a=t),f("intent"))},j=function(e){e.target.nodeName?(s=e.target.nodeName.toLowerCase(),o.setAttribute("data-whatelement",s),e.target.classList&&e.target.classList.length&&o.setAttribute("data-whatclasses",e.target.classList.toString().replace(" ",","))):x()},x=function(){s=null,o.removeAttribute("data-whatelement"),o.removeAttribute("data-whatclasses")},E=function(e,t){if(g)try{window.sessionStorage.setItem("what-"+e,t)}catch(r){}},k=function(e){return"number"==typeof e.pointerType?I[e.pointerType]:"pen"===e.pointerType?"touch":e.pointerType},O=function(e){var t=Date.now(),r="mouse"===e&&"touch"===i&&t-b<200;return b=t,r},P=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},N=function(e){for(var t=0,r=c.length;t<r;t++)c[t].type===e&&c[t].fn.call(void 0,"input"===e?i:a)},_=function(e){v.x!==e.screenX||v.y!==e.screenY?(h=!1,v.x=e.screenX,v.y=e.screenY):h=!0},R=function(e,t){var r=window.Element.prototype;if(r.matches||(r.matches=r.msMatchesSelector||r.webkitMatchesSelector),r.closest)return e.closest(t);do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null};return"addEventListener"in window&&Array.prototype.indexOf&&(y[P()]="mouse",e=!S||{passive:!0,capture:!0},document.addEventListener("DOMContentLoaded",D,!0),window.PointerEvent?(window.addEventListener("pointerdown",d,!0),window.addEventListener("pointermove",m,!0)):window.MSPointerEvent?(window.addEventListener("MSPointerDown",d,!0),window.addEventListener("MSPointerMove",m,!0)):(window.addEventListener("mousedown",d,!0),window.addEventListener("mousemove",m,!0),"ontouchstart"in window&&(window.addEventListener("touchstart",d,e),window.addEventListener("touchend",d,!0))),window.addEventListener(P(),m,e),window.addEventListener("keydown",d,!0),window.addEventListener("keyup",d,!0),window.addEventListener("focusin",j,!0),window.addEventListener("focusout",x,!0)),{ask:function(e){return"intent"===e?a:i},element:function(){return s},ignoreKeys:function(e){M=e},specificKeys:function(e){w=e},registerOnChange:function(e,t){c.push({fn:e,type:t||"input"})},unRegisterOnChange:function(e){var t=function(e){for(var t=0,r=c.length;t<r;t++)if(c[t].fn===e)return t}(e);(t||0===t)&&c.splice(t,1)},clearStorage:function(){window.sessionStorage.clear()}}}()}])});